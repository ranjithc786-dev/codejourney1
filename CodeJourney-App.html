<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
<meta name="theme-color" content="#060810">
<meta name="mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
<meta name="apple-mobile-web-app-title" content="CodeJourney">
<link rel="apple-touch-icon" href="icon.svg">
<link rel="manifest" href="manifest.json">
<link href="https://fonts.googleapis.com/css2?family=Barlow+Condensed:wght@700;800;900&family=JetBrains+Mono:wght@400;500&family=Barlow:wght@400;500;600&display=swap" rel="stylesheet">
<title>CodeJourney</title>
<style>
:root{
  --bg:#060810;--s1:#0c0f1e;--s2:#111528;--s3:#181c30;
  --border:#1e2340;--text:#e2e8ff;--muted:#5a6080;--dim:#2a3050;
  --purple:#7c3aed;--violet:#a78bfa;--p-glow:rgba(124,58,237,.15);--p-border:rgba(124,58,237,.3);
  --green:#10b981;--gold:#f59e0b;--red:#ef4444;--blue:#3b82f6;--cyan:#06b6d4;
  --sb:env(safe-area-inset-bottom,0px);--st:env(safe-area-inset-top,0px);
}
*{box-sizing:border-box;margin:0;padding:0;-webkit-tap-highlight-color:transparent;-webkit-text-size-adjust:100%}
html,body{background:var(--bg);color:var(--text);font-family:'Barlow',sans-serif;height:100%;overflow:hidden;position:fixed;width:100%;-webkit-font-smoothing:antialiased}
/* â”€â”€ INSTALL SCREEN â”€â”€ */
#installScreen{
  position:fixed;inset:0;z-index:9999;background:var(--bg);
  display:flex;flex-direction:column;align-items:center;justify-content:center;
  padding:32px 24px;text-align:center;
}
#installScreen.hidden{display:none}
.is-logo{width:80px;height:80px;background:var(--purple);border-radius:22px;
  display:flex;align-items:center;justify-content:center;font-size:2.5rem;
  box-shadow:0 0 40px rgba(124,58,237,.5);margin-bottom:20px}
.is-title{font-family:'Barlow Condensed',sans-serif;font-weight:900;font-size:2rem;margin-bottom:6px}
.is-title span{color:var(--violet)}
.is-sub{font-size:.85rem;color:var(--muted);line-height:1.6;margin-bottom:32px;max-width:300px}
.is-btn{
  width:100%;max-width:300px;padding:16px;background:var(--purple);border:none;border-radius:14px;
  color:#fff;font-family:'Barlow Condensed',sans-serif;font-weight:900;font-size:1.1rem;
  letter-spacing:1px;cursor:pointer;box-shadow:0 6px 24px rgba(124,58,237,.4);margin-bottom:12px;
}
.is-skip{font-size:.8rem;color:var(--muted);cursor:pointer;padding:8px;text-decoration:underline;text-underline-offset:3px}
/* iOS steps */
.ios-steps{width:100%;max-width:340px;margin-bottom:24px;text-align:left}
.ios-step{display:flex;align-items:center;gap:12px;padding:12px 0;border-bottom:1px solid var(--border)}
.ios-step:last-child{border-bottom:none}
.ios-n{width:28px;height:28px;background:var(--purple);border-radius:50%;
  display:flex;align-items:center;justify-content:center;
  font-family:'Barlow Condensed',sans-serif;font-weight:900;font-size:.9rem;flex-shrink:0}
.ios-t{font-size:.84rem;line-height:1.45}
.ios-t strong{color:var(--violet)}
.ios-arrow{font-size:1.4rem;margin-bottom:8px;animation:bounce .8s ease infinite alternate}
@keyframes bounce{from{transform:translateY(0)}to{transform:translateY(6px)}}
/* â”€â”€ APP SHELL â”€â”€ */
#app{display:flex;flex-direction:column;height:100%}
.app-header{
  flex-shrink:0;padding:calc(var(--st) + 10px) 16px 10px;background:var(--s1);
  border-bottom:1px solid var(--border);display:flex;align-items:center;justify-content:space-between;
}
.logo-row{display:flex;align-items:center;gap:8px}
.logo-box{width:32px;height:32px;background:var(--purple);border-radius:8px;
  display:flex;align-items:center;justify-content:center;font-size:.95rem;
  box-shadow:0 0 14px rgba(124,58,237,.45)}
.logo-name{font-family:'Barlow Condensed',sans-serif;font-weight:800;font-size:1rem}
.logo-name span{color:var(--violet)}
.hdr-right{display:flex;gap:6px;align-items:center}
.badge{border-radius:20px;padding:4px 9px;font-family:'JetBrains Mono',monospace;font-size:10px}
.badge-xp{background:var(--p-glow);border:1px solid var(--p-border);color:var(--violet)}
.badge-str{background:rgba(245,158,11,.1);border:1px solid rgba(245,158,11,.3);color:var(--gold)}
.app-scroll{flex:1;overflow-y:auto;overflow-x:hidden;-webkit-overflow-scrolling:touch;overscroll-behavior:contain}
.bottom-nav{flex-shrink:0;display:flex;background:var(--s1);border-top:1px solid var(--border);padding-bottom:calc(var(--sb) + 4px)}
.nav-btn{flex:1;display:flex;flex-direction:column;align-items:center;gap:2px;padding:8px 4px 4px;cursor:pointer;user-select:none}
.nav-btn .ic{font-size:1.2rem;transition:transform .15s}
.nav-btn .lb{font-family:'Barlow Condensed',sans-serif;font-size:9px;letter-spacing:1px;text-transform:uppercase;color:var(--muted)}
.nav-btn.on .lb{color:var(--violet)}.nav-btn.on .ic{transform:scale(1.12)}
/* â”€â”€ PAGES â”€â”€ */
.pg{display:none}.pg.on{display:block;animation:fi .2s ease}
@keyframes fi{from{opacity:0}to{opacity:1}}
/* â”€â”€ HOME â”€â”€ */
.hero{padding:18px 16px 0;position:relative}
.hero::before{content:'';position:absolute;top:-40px;left:-40px;width:160px;height:160px;
  background:radial-gradient(circle,rgba(124,58,237,.1),transparent 70%);pointer-events:none}
.greet{font-family:'JetBrains Mono',monospace;font-size:9px;letter-spacing:2px;text-transform:uppercase;color:var(--muted);margin-bottom:4px}
.day-hdr{font-family:'Barlow Condensed',sans-serif;font-size:1.7rem;font-weight:900;line-height:1;margin-bottom:14px}
.day-hdr span{color:var(--violet)}
.prog-card{display:flex;align-items:center;gap:14px;background:var(--s2);border:1px solid var(--border);border-radius:14px;padding:14px 16px;margin-bottom:14px}
.ring-w{position:relative;width:68px;height:68px;flex-shrink:0}
.ring-w svg{transform:rotate(-90deg)}
.r-bg{fill:none;stroke:var(--s3);stroke-width:6}
.r-fill{fill:none;stroke:url(#rg);stroke-width:6;stroke-linecap:round;stroke-dasharray:188.5;stroke-dashoffset:188.5;transition:stroke-dashoffset .9s ease}
.ring-txt{position:absolute;inset:0;display:flex;flex-direction:column;align-items:center;justify-content:center}
.r-pct{font-family:'Barlow Condensed',sans-serif;font-size:1.2rem;font-weight:900;line-height:1}
.r-sub{font-family:'JetBrains Mono',monospace;font-size:7px;color:var(--muted);letter-spacing:1px}
.prog-info{flex:1;min-width:0}
.pi-ph{font-family:'Barlow Condensed',sans-serif;font-size:.9rem;font-weight:700;color:var(--violet);margin-bottom:2px}
.pi-nm{font-size:.74rem;color:var(--muted);line-height:1.4;margin-bottom:7px}
.pi-dy{font-family:'JetBrains Mono',monospace;font-size:9px}
.pi-dy span{color:var(--gold)}
.sec{display:flex;align-items:center;justify-content:space-between;padding:0 16px;margin-bottom:7px;margin-top:2px}
.sec-t{font-family:'Barlow Condensed',sans-serif;font-weight:800;font-size:.95rem;text-transform:uppercase}
.sec-c{font-family:'JetBrains Mono',monospace;font-size:9px;color:var(--muted)}
/* tasks */
.task-list{padding:0 16px;margin-bottom:14px}
.task{display:flex;align-items:flex-start;gap:10px;padding:11px 13px;background:var(--s2);border:1px solid var(--border);border-radius:11px;margin-bottom:6px;cursor:pointer;border-left-width:3px;border-left-style:solid;user-select:none;transition:opacity .2s}
.task.done{opacity:.55}.task.done .t-txt{text-decoration:line-through;color:var(--muted)}
.chk{width:20px;height:20px;border:2px solid var(--border);border-radius:5px;flex-shrink:0;display:flex;align-items:center;justify-content:center;font-size:11px;transition:all .2s;margin-top:1px}
.task.done .chk{background:var(--green);border-color:var(--green);color:#fff}
.t-body{flex:1;min-width:0}
.t-txt{font-size:.83rem;font-weight:500;line-height:1.35;margin-bottom:3px}
.t-meta{display:flex;gap:5px;flex-wrap:wrap;align-items:center}
.tag{font-family:'JetBrains Mono',monospace;font-size:8px;letter-spacing:.5px;text-transform:uppercase;padding:2px 5px;border-radius:4px}
.tl{background:rgba(59,130,246,.1);color:var(--blue);border:1px solid rgba(59,130,246,.2)}
.tb{background:rgba(245,158,11,.1);color:var(--gold);border:1px solid rgba(245,158,11,.2)}
.tr{background:rgba(16,185,129,.1);color:var(--green);border:1px solid rgba(16,185,129,.2)}
.ta{background:rgba(124,58,237,.1);color:var(--violet);border:1px solid rgba(124,58,237,.2)}
.tc{background:rgba(6,182,212,.1);color:var(--cyan);border:1px solid rgba(6,182,212,.2)}
.t-xp{font-family:'JetBrains Mono',monospace;font-size:9px;color:var(--gold)}
/* non-neg */
.nn-grid{display:grid;grid-template-columns:repeat(3,1fr);gap:6px;padding:0 16px;margin-bottom:14px}
.nn{background:var(--s2);border:1px solid var(--border);border-radius:10px;padding:9px 6px;text-align:center;cursor:pointer;user-select:none;transition:all .15s}
.nn.done{background:rgba(16,185,129,.08);border-color:rgba(16,185,129,.3)}
.nn-e{font-size:1.2rem;margin-bottom:3px}
.nn-n{font-size:8px;color:var(--muted);line-height:1.3}
.nn.done .nn-n{color:var(--green)}
/* calendar */
.cal{display:grid;grid-template-columns:repeat(7,1fr);gap:3px;padding:0 16px;margin-bottom:16px}
.cal-d{aspect-ratio:1;border-radius:4px;background:var(--s2);border:1px solid var(--border);display:flex;align-items:center;justify-content:center;font-family:'JetBrains Mono',monospace;font-size:8px;color:var(--muted)}
.cal-d.done{background:var(--purple);border-color:var(--purple);color:#fff}
.cal-d.today{border-color:var(--violet);box-shadow:0 0 6px rgba(124,58,237,.5)}
/* â”€â”€ PHASES â”€â”€ */
.phases{padding:12px 16px}
.ph-card{background:var(--s2);border:1px solid var(--border);border-radius:14px;margin-bottom:10px;overflow:hidden;cursor:pointer}
.ph-card.cur{border-color:var(--purple);box-shadow:0 0 16px rgba(124,58,237,.12)}
.ph-card.done2{border-color:rgba(16,185,129,.35)}
.ph-hdr{display:flex;align-items:center;gap:12px;padding:13px 15px}
.ph-badge{width:36px;height:36px;border-radius:9px;display:flex;align-items:center;justify-content:center;font-size:1rem;flex-shrink:0}
.ph-info{flex:1;min-width:0}
.ph-name{font-family:'Barlow Condensed',sans-serif;font-weight:800;font-size:.93rem;margin-bottom:2px;line-height:1.2}
.ph-wk{font-family:'JetBrains Mono',monospace;font-size:9px;color:var(--muted);letter-spacing:.5px}
.ph-prog{padding:0 15px 11px}
.ph-bar{height:3px;background:var(--s3);border-radius:2px;overflow:hidden;margin-bottom:4px}
.ph-fill{height:100%;border-radius:2px;transition:width .4s}
.ph-st{display:flex;justify-content:space-between;font-family:'JetBrains Mono',monospace;font-size:9px;color:var(--muted)}
.ph-st .gn{color:var(--green)}
/* â”€â”€ MODAL â”€â”€ */
.overlay{position:fixed;inset:0;background:rgba(6,8,16,.87);z-index:400;display:none;align-items:flex-end;backdrop-filter:blur(4px)}
.overlay.on{display:flex}
.sheet{background:var(--s1);border-radius:22px 22px 0 0;border-top:1px solid var(--border);width:100%;max-height:88vh;overflow-y:auto;padding:0 0 calc(var(--sb) + 18px);animation:su .3s ease}
@keyframes su{from{transform:translateY(100%)}to{transform:translateY(0)}}
.sh-hand{width:38px;height:4px;background:var(--dim);border-radius:2px;margin:11px auto}
.sh-hdr{padding:4px 18px 13px}
.sh-title{font-family:'Barlow Condensed',sans-serif;font-weight:800;font-size:1.25rem;margin-bottom:3px}
.sh-sub{font-family:'JetBrains Mono',monospace;font-size:9px;color:var(--muted);letter-spacing:.5px}
.sh-tasks{padding:0 18px}
.mt{display:flex;align-items:flex-start;gap:10px;padding:10px 0;border-bottom:1px solid var(--border);cursor:pointer;user-select:none}
.mt:last-child{border-bottom:none}
.mt-chk{width:19px;height:19px;border:1.5px solid var(--border);border-radius:5px;flex-shrink:0;display:flex;align-items:center;justify-content:center;font-size:10px;margin-top:1px;transition:all .2s}
.mt.done .mt-chk{background:var(--green);border-color:var(--green);color:#fff}
.mt-t{flex:1;font-size:.81rem;line-height:1.45}
.mt.done .mt-t{color:var(--muted);text-decoration:line-through}
.mt-x{font-family:'JetBrains Mono',monospace;font-size:9px;color:var(--gold);flex-shrink:0;margin-top:2px}
/* â”€â”€ JOURNAL â”€â”€ */
.journal{padding:13px 16px}
.j-date{font-family:'JetBrains Mono',monospace;font-size:9px;color:var(--muted);letter-spacing:2px;text-transform:uppercase;margin-bottom:10px}
.j-lbl{font-family:'Barlow Condensed',sans-serif;font-weight:700;font-size:.82rem;color:var(--violet);margin-bottom:5px}
.j-ta{width:100%;background:var(--s2);border:1px solid var(--border);border-radius:9px;padding:10px 12px;color:var(--text);font-family:'Barlow',sans-serif;font-size:.82rem;line-height:1.55;resize:none;outline:none;transition:border-color .2s;min-height:62px;margin-bottom:10px}
.j-ta:focus{border-color:var(--purple)}
.j-ta::placeholder{color:var(--muted)}
.save-btn{width:100%;padding:13px;background:var(--purple);border:none;border-radius:11px;color:#fff;font-family:'Barlow Condensed',sans-serif;font-weight:900;font-size:1rem;letter-spacing:1px;text-transform:uppercase;cursor:pointer;box-shadow:0 4px 16px rgba(124,58,237,.35);margin-bottom:18px}
.save-btn:active{transform:scale(.98)}
.pe-title{font-family:'Barlow Condensed',sans-serif;font-weight:800;font-size:.93rem;text-transform:uppercase;margin-bottom:9px;color:var(--muted)}
.e-card{background:var(--s2);border:1px solid var(--border);border-radius:10px;padding:11px 13px;margin-bottom:8px}
.e-date{font-family:'JetBrains Mono',monospace;font-size:9px;color:var(--muted);margin-bottom:5px}
.e-body{font-size:.79rem;line-height:1.55}
/* â”€â”€ STATS â”€â”€ */
.stats{padding:13px 16px}
.lvl-card{background:linear-gradient(135deg,rgba(124,58,237,.2),rgba(6,182,212,.08));border:1px solid var(--p-border);border-radius:14px;padding:18px 16px;margin-bottom:14px;text-align:center}
.lv-l{font-family:'Barlow Condensed',sans-serif;font-weight:900;font-size:.78rem;letter-spacing:3px;text-transform:uppercase;color:var(--violet);margin-bottom:5px}
.lv-t{font-family:'Barlow Condensed',sans-serif;font-weight:900;font-size:1.6rem;line-height:1;margin-bottom:13px}
.xp-bw{background:var(--s3);border-radius:4px;height:7px;overflow:hidden;margin-bottom:6px}
.xp-bf{height:100%;background:linear-gradient(90deg,var(--purple),var(--cyan));border-radius:4px;transition:width .5s}
.xp-bt{font-family:'JetBrains Mono',monospace;font-size:9px;color:var(--muted)}
.sg{display:grid;grid-template-columns:1fr 1fr;gap:8px;margin-bottom:14px}
.sc{background:var(--s2);border:1px solid var(--border);border-radius:12px;padding:14px 10px;text-align:center}
.sn{font-family:'Barlow Condensed',sans-serif;font-size:1.9rem;font-weight:900;line-height:1;margin-bottom:2px}
.sl{font-family:'JetBrains Mono',monospace;font-size:8px;letter-spacing:.5px;text-transform:uppercase;color:var(--muted)}
.ach-t{font-family:'Barlow Condensed',sans-serif;font-weight:800;font-size:.95rem;text-transform:uppercase;margin-bottom:9px}
.ach-g{display:grid;grid-template-columns:repeat(3,1fr);gap:6px;margin-bottom:14px}
.ach{background:var(--s2);border:1px solid var(--border);border-radius:9px;padding:11px 6px;text-align:center;opacity:.3;transition:all .3s}
.ach.on{opacity:1;border-color:var(--gold);background:rgba(245,158,11,.05)}
.a-e{font-size:1.45rem;margin-bottom:4px}
.a-n{font-size:8px;color:var(--muted);line-height:1.3}
.ach.on .a-n{color:var(--gold)}
/* â”€â”€ TOAST & BURST â”€â”€ */
.toast{position:fixed;top:calc(var(--st) + 58px);left:50%;transform:translateX(-50%) translateY(-16px);opacity:0;background:var(--s3);border:1px solid var(--border);border-radius:18px;padding:8px 16px;font-family:'JetBrains Mono',monospace;font-size:10px;color:var(--text);z-index:800;transition:all .25s;pointer-events:none;white-space:nowrap;box-shadow:0 5px 20px rgba(0,0,0,.5)}
.toast.on{opacity:1;transform:translateX(-50%) translateY(0)}
.toast.gld{color:var(--gold);border-color:rgba(245,158,11,.3)}
.toast.grn{color:var(--green);border-color:rgba(16,185,129,.3)}
.burst{position:fixed;font-family:'Barlow Condensed',sans-serif;font-weight:900;font-size:1.1rem;color:var(--gold);pointer-events:none;z-index:799;animation:bu .75s ease forwards}
@keyframes bu{0%{opacity:1;transform:translateY(0) scale(1)}100%{opacity:0;transform:translateY(-52px) scale(1.3)}}
.empty{text-align:center;padding:28px 16px;color:var(--muted);font-size:.82rem;line-height:1.65}
.empty-i{font-size:2rem;margin-bottom:8px}
::-webkit-scrollbar{width:2px}::-webkit-scrollbar-thumb{background:var(--dim);border-radius:2px}
</style>
</head>
<body>

<!-- â•â•â•â• INSTALL SCREEN â•â•â•â• -->
<div id="installScreen">
  <div class="is-logo">âš¡</div>
  <div class="is-title">Code<span>Journey</span></div>
  <div class="is-sub">Your 1-year developer plan. Track progress, earn XP, build daily habits.</div>
  <!-- shown for Android/desktop -->
  <button class="is-btn" id="installBtn" style="display:none">ğŸ“² Install App</button>
  <!-- shown for iOS -->
  <div id="iosGuide" style="display:none;width:100%;max-width:340px">
    <div class="ios-arrow">ğŸ‘‡</div>
    <div class="ios-steps">
      <div class="ios-step"><div class="ios-n">1</div><div class="ios-t">Tap the <strong>Share</strong> button (â–¡â†‘) at the bottom of Safari</div></div>
      <div class="ios-step"><div class="ios-n">2</div><div class="ios-t">Scroll down and tap <strong>"Add to Home Screen"</strong></div></div>
      <div class="ios-step"><div class="ios-n">3</div><div class="ios-t">Tap <strong>"Add"</strong> â€” the app appears on your home screen!</div></div>
    </div>
  </div>
  <div class="is-skip" id="skipBtn">Continue in browser â†’</div>
</div>

<!-- â•â•â•â• APP â•â•â•â• -->
<div id="app" style="display:none">
  <div class="app-header">
    <div class="logo-row">
      <div class="logo-box">âš¡</div>
      <div class="logo-name">Code<span>Journey</span></div>
    </div>
    <div class="hdr-right">
      <div class="badge badge-str" id="strBadge">ğŸ”¥ 0</div>
      <div class="badge badge-xp">âš¡ <span id="xpVal">0</span></div>
    </div>
  </div>

  <div class="app-scroll" id="scrl">

    <!-- HOME -->
    <div class="pg on" id="pg-home">
      <div class="hero">
        <div class="greet" id="greet">Good morning, Developer</div>
        <div class="day-hdr">Day <span id="dayN">1</span> <span style="color:var(--muted);font-size:1rem">of 365</span></div>
        <div class="prog-card">
          <div class="ring-w">
            <svg width="68" height="68" viewBox="0 0 68 68">
              <defs><linearGradient id="rg" x1="0%" y1="0%" x2="100%" y2="0%"><stop offset="0%" style="stop-color:#7c3aed"/><stop offset="100%" style="stop-color:#06b6d4"/></linearGradient></defs>
              <circle class="r-bg" cx="34" cy="34" r="30"/>
              <circle class="r-fill" id="rFill" cx="34" cy="34" r="30"/>
            </svg>
            <div class="ring-txt"><div class="r-pct" id="rPct">0%</div><div class="r-sub">done</div></div>
          </div>
          <div class="prog-info">
            <div class="pi-ph" id="piPh">Phase 1 ğŸ</div>
            <div class="pi-nm" id="piNm">Python & Programming Fundamentals</div>
            <div class="pi-dy">Day <span id="piD">1</span> Â· <span id="piR">365</span> left</div>
          </div>
        </div>
      </div>
      <div class="sec"><div class="sec-t">Today's Tasks</div><div class="sec-c" id="tCount">0/0</div></div>
      <div class="task-list" id="taskList"></div>
      <div class="sec"><div class="sec-t">Daily Wins</div><div class="sec-c" id="nnCount">0/6</div></div>
      <div class="nn-grid" id="nnGrid"></div>
      <div class="sec"><div class="sec-t">28-Day Streak</div></div>
      <div class="cal" id="calGrid"></div>
      <div style="height:14px"></div>
    </div>

    <!-- PHASES -->
    <div class="pg" id="pg-phases">
      <div class="phases" id="phasesList"></div>
    </div>

    <!-- JOURNAL -->
    <div class="pg" id="pg-journal">
      <div class="journal">
        <div class="j-date" id="jDate"></div>
        <div class="j-lbl">ğŸ”¨ What did I build or learn?</div>
        <textarea class="j-ta" id="jB" placeholder="I built a..." rows="2"></textarea>
        <div class="j-lbl">ğŸ’¡ What finally clicked?</div>
        <textarea class="j-ta" id="jC" placeholder="It clicked when..." rows="2"></textarea>
        <div class="j-lbl">ğŸ¤– How did Claude help?</div>
        <textarea class="j-ta" id="jCl" placeholder="I asked Claude to..." rows="2"></textarea>
        <div class="j-lbl">ğŸ¯ Tomorrow's focus</div>
        <textarea class="j-ta" id="jT" placeholder="Tomorrow I'll tackle..." rows="2"></textarea>
        <button class="save-btn" onclick="saveJ()">Save Entry +25 XP</button>
        <div class="pe-title">Past Entries</div>
        <div id="eList"></div>
        <div style="height:12px"></div>
      </div>
    </div>

    <!-- STATS -->
    <div class="pg" id="pg-stats">
      <div class="stats">
        <div class="lvl-card">
          <div class="lv-l" id="lvlLbl">Level 1</div>
          <div class="lv-t" id="lvlTitle">Absolute Beginner</div>
          <div class="xp-bw"><div class="xp-bf" id="xpBar" style="width:0%"></div></div>
          <div class="xp-bt" id="xpTxt">0 / 500 XP to next level</div>
        </div>
        <div class="sg">
          <div class="sc"><div class="sn" id="ss" style="color:var(--red)">0</div><div class="sl">Streak ğŸ”¥</div></div>
          <div class="sc"><div class="sn" id="st" style="color:var(--green)">0</div><div class="sl">Tasks âœ…</div></div>
          <div class="sc"><div class="sn" id="sx" style="color:var(--gold)">0</div><div class="sl">XP âš¡</div></div>
          <div class="sc"><div class="sn" id="sj" style="color:var(--cyan)">0</div><div class="sl">Journals ğŸ“”</div></div>
        </div>
        <div class="ach-t">Achievements</div>
        <div class="ach-g" id="achGrid"></div>
        <div class="ach-t">Phase Progress</div>
        <div id="phBars" style="margin-bottom:20px"></div>
      </div>
    </div>

  </div>

  <div class="bottom-nav">
    <div class="nav-btn on" id="nb-home" onclick="go('home')"><div class="ic">ğŸ </div><div class="lb">Today</div></div>
    <div class="nav-btn" id="nb-phases" onclick="go('phases')"><div class="ic">ğŸ—ºï¸</div><div class="lb">Phases</div></div>
    <div class="nav-btn" id="nb-journal" onclick="go('journal')"><div class="ic">ğŸ“”</div><div class="lb">Journal</div></div>
    <div class="nav-btn" id="nb-stats" onclick="go('stats')"><div class="ic">ğŸ“Š</div><div class="lb">Stats</div></div>
  </div>
</div>

<!-- PHASE MODAL -->
<div class="overlay" id="overlay" onclick="closeM(event)">
  <div class="sheet">
    <div class="sh-hand"></div>
    <div class="sh-hdr"><div class="sh-title" id="mTitle"></div><div class="sh-sub" id="mSub"></div></div>
    <div class="sh-tasks" id="mTasks"></div>
    <div style="height:18px"></div>
  </div>
</div>

<div class="toast" id="toast"></div>

<script>
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// PLAN DATA
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
const PLAN=[
  {id:1,name:"Python & Programming Fundamentals",emoji:"ğŸ",color:"#7c3aed",weeks:"Weeks 1â€“4",desc:"Variables, loops, functions, OOP, file I/O, error handling",tasks:[
    {id:"1-1",text:"Install Python, VS Code, Git. Setup GitHub account",tag:"build",xp:50},
    {id:"1-2",text:"CS50P Lecture 0 â€” Functions, Variables",tag:"learn",xp:30},
    {id:"1-3",text:"Write FizzBuzz from memory. Push to GitHub",tag:"build",xp:40},
    {id:"1-4",text:"Ask Claude: 'Explain Python data types with examples from my code'",tag:"claude",xp:20},
    {id:"1-5",text:"CS50P Lecture 1 â€” Conditionals",tag:"learn",xp:30},
    {id:"1-6",text:"Build: Student Grade Calculator CLI",tag:"build",xp:60},
    {id:"1-7",text:"CS50P Lecture 2 â€” Loops",tag:"learn",xp:30},
    {id:"1-8",text:"Build: Number Guessing Game with high score",tag:"build",xp:60},
    {id:"1-9",text:"CS50P Lecture 3 â€” Exceptions & Functions",tag:"learn",xp:30},
    {id:"1-10",text:"10 Exercism Python exercises. Claude reviews your solutions",tag:"review",xp:80},
    {id:"1-11",text:"CS50P Lecture 4 â€” Libraries & APIs",tag:"learn",xp:30},
    {id:"1-12",text:"Build: File I/O Budget Tracker saving to JSON",tag:"build",xp:70},
    {id:"1-13",text:"CS50P Lecture 5 â€” Unit Tests with pytest",tag:"learn",xp:30},
    {id:"1-14",text:"OOP: Classes, __init__, methods, inheritance",tag:"learn",xp:40},
    {id:"1-15",text:"Build: OOP Quiz Game (Question/Quiz/Player classes)",tag:"build",xp:80},
    {id:"1-16",text:"Capstone: ETL Data Pipeline (pure Python)",tag:"build",xp:150},
    {id:"1-17",text:"Claude Code review: 'Review my Python code as a senior dev'",tag:"claude",xp:30},
    {id:"1-18",text:"Push all projects to GitHub. Write READMEs",tag:"build",xp:50},
  ]},
  {id:2,name:"HTML, CSS & JavaScript",emoji:"ğŸ¨",color:"#2563eb",weeks:"Weeks 5â€“7",desc:"HTML5, CSS3, Flexbox, Grid, responsive design, vanilla JS",tasks:[
    {id:"2-1",text:"HTML5 semantic tags, document structure, forms, tables",tag:"learn",xp:30},
    {id:"2-2",text:"CSS: Box model, selectors, specificity, units",tag:"learn",xp:30},
    {id:"2-3",text:"Flexbox Froggy game (complete all 24 levels)",tag:"build",xp:50},
    {id:"2-4",text:"Build: Personal bio page with Flexbox. Deploy to GitHub Pages",tag:"build",xp:70},
    {id:"2-5",text:"CSS Grid Garden (complete all 28 levels)",tag:"build",xp:50},
    {id:"2-6",text:"Media queries & responsive design principles",tag:"learn",xp:30},
    {id:"2-7",text:"JavaScript basics: variables, functions, DOM, events",tag:"learn",xp:40},
    {id:"2-8",text:"DOM manipulation: querySelector, addEventListener",tag:"learn",xp:30},
    {id:"2-9",text:"Fetch API, Promises, async/await",tag:"learn",xp:50},
    {id:"2-10",text:"Build: Weather App using OpenWeatherMap API",tag:"build",xp:90},
    {id:"2-11",text:"Claude: 'Why isn't my CSS centering? [paste code]'",tag:"claude",xp:20},
    {id:"2-12",text:"Capstone: Portfolio site deployed to Vercel",tag:"build",xp:150},
  ]},
  {id:3,name:"React & Modern Frontend",emoji:"âš›ï¸",color:"#0891b2",weeks:"Weeks 8â€“11",desc:"Components, props, state, hooks, React Router, API integration",tasks:[
    {id:"3-1",text:"React fundamentals: JSX, components, props",tag:"learn",xp:40},
    {id:"3-2",text:"useState and useEffect hooks â€” deep understanding",tag:"learn",xp:50},
    {id:"3-3",text:"Build: Counter + Todo App with hooks",tag:"build",xp:70},
    {id:"3-4",text:"React Router â€” client-side navigation",tag:"learn",xp:40},
    {id:"3-5",text:"Context API and useContext",tag:"learn",xp:40},
    {id:"3-6",text:"Build: GitHub Profile Finder (search + API)",tag:"build",xp:80},
    {id:"3-7",text:"Claude Code: 'Scaffold a React app for a task manager'",tag:"claude",xp:30},
    {id:"3-8",text:"Custom hooks â€” extract reusable logic",tag:"learn",xp:50},
    {id:"3-9",text:"React Query / TanStack Query for data fetching",tag:"learn",xp:50},
    {id:"3-10",text:"Build: Movie search app with pagination",tag:"build",xp:90},
    {id:"3-11",text:"Capstone: Personal Portfolio in React. Deploy to Vercel",tag:"build",xp:150},
  ]},
  {id:4,name:"Node.js, Express & Databases",emoji:"ğŸ”§",color:"#059669",weeks:"Weeks 12â€“15",desc:"REST APIs, Express, PostgreSQL, SQL, JWT auth, deployment",tasks:[
    {id:"4-1",text:"Node.js fundamentals: modules, npm, file system",tag:"learn",xp:40},
    {id:"4-2",text:"Express: routes, middleware, req/res cycle",tag:"learn",xp:50},
    {id:"4-3",text:"Build: Notes API with full CRUD. Test in Postman",tag:"build",xp:90},
    {id:"4-4",text:"PostgreSQL setup. SQL: CREATE, INSERT, SELECT, JOIN",tag:"learn",xp:60},
    {id:"4-5",text:"Connect PostgreSQL to Express using pg library",tag:"build",xp:70},
    {id:"4-6",text:"Claude Code: 'Design a database schema for [your project]'",tag:"claude",xp:30},
    {id:"4-7",text:"Authentication: bcrypt password hashing",tag:"learn",xp:50},
    {id:"4-8",text:"JWT tokens: signing, verifying, refresh tokens",tag:"learn",xp:60},
    {id:"4-9",text:"Environment variables, .env files, security basics",tag:"learn",xp:30},
    {id:"4-10",text:"Build: Full auth system (register, login, protected routes)",tag:"build",xp:100},
    {id:"4-11",text:"Capstone: Full-Stack Finance Tracker (React + Node + Postgres)",tag:"build",xp:200},
    {id:"4-12",text:"Deploy: Frontend â†’ Vercel, Backend + DB â†’ Railway",tag:"build",xp:80},
  ]},
  {id:5,name:"TypeScript & Code Quality",emoji:"ğŸ“˜",color:"#d97706",weeks:"Weeks 16â€“19",desc:"TypeScript, testing, clean code, SOLID principles, algorithms",tasks:[
    {id:"5-1",text:"TypeScript: types, interfaces, generics, tsconfig.json",tag:"learn",xp:60},
    {id:"5-2",text:"Convert Weather App from JavaScript to TypeScript",tag:"build",xp:80},
    {id:"5-3",text:"Claude Code: 'Add proper TypeScript types to my project'",tag:"claude",xp:30},
    {id:"5-4",text:"Unit testing with Vitest â€” test utilities and components",tag:"learn",xp:50},
    {id:"5-5",text:"Integration testing â€” testing API endpoints",tag:"learn",xp:50},
    {id:"5-6",text:"Clean code principles: naming, single responsibility",tag:"learn",xp:40},
    {id:"5-7",text:"Daily LeetCode Easy â€” 1 problem/day for 3 weeks",tag:"build",xp:30},
    {id:"5-8",text:"Big O notation: time and space complexity",tag:"learn",xp:50},
    {id:"5-9",text:"Claude: 'Review my code for clean code violations'",tag:"claude",xp:30},
    {id:"5-10",text:"Build: TypeScript full-stack project with 80%+ test coverage",tag:"build",xp:150},
  ]},
  {id:6,name:"DevOps & Deployment",emoji:"ğŸš€",color:"#dc2626",weeks:"Weeks 20â€“23",desc:"Docker, GitHub Actions CI/CD, cloud deployment, monitoring",tasks:[
    {id:"6-1",text:"Docker: containers, images, Dockerfile, docker-compose",tag:"learn",xp:70},
    {id:"6-2",text:"Claude Code: 'Write a Dockerfile for my Node.js app, explain each line'",tag:"claude",xp:30},
    {id:"6-3",text:"GitHub Actions: first CI pipeline (lint, test, build)",tag:"build",xp:80},
    {id:"6-4",text:"CD pipeline: auto-deploy to Railway on merge to main",tag:"build",xp:90},
    {id:"6-5",text:"Environment management across dev/staging/prod",tag:"learn",xp:40},
    {id:"6-6",text:"Logging best practices and error monitoring",tag:"learn",xp:40},
    {id:"6-7",text:"Security basics: HTTPS, CORS, rate limiting, sanitisation",tag:"learn",xp:60},
    {id:"6-8",text:"AWS basics: S3 for file storage, understanding EC2",tag:"learn",xp:60},
    {id:"6-9",text:"Build: Dockerise an existing full-stack project",tag:"build",xp:100},
    {id:"6-10",text:"Deploy with full CI/CD pipeline. Zero-downtime deploys",tag:"build",xp:120},
  ]},
  {id:7,name:"AI Integration & Portfolio",emoji:"ğŸ¤–",color:"#7c3aed",weeks:"Weeks 24â€“30",desc:"Claude API, OpenAI, RAG, building AI-powered apps",tasks:[
    {id:"7-1",text:"Claude API basics: messages API, system prompts, streaming",tag:"learn",xp:60},
    {id:"7-2",text:"Build: AI-powered chatbot feature for existing app",tag:"build",xp:100},
    {id:"7-3",text:"Embeddings and vector databases (pgvector, Pinecone)",tag:"learn",xp:70},
    {id:"7-4",text:"RAG architecture: document Q&A system",tag:"build",xp:120},
    {id:"7-5",text:"Build: AI Journal app using Claude API for insights",tag:"build",xp:100},
    {id:"7-6",text:"Claude Code: Use as project lead on capstone build",tag:"claude",xp:50},
    {id:"7-7",text:"Portfolio Project 1: Full-stack SaaS with AI features",tag:"build",xp:200},
    {id:"7-8",text:"Portfolio Project 2: AI-powered tool solving real problem",tag:"build",xp:200},
    {id:"7-9",text:"Write case studies for all portfolio projects",tag:"review",xp:80},
    {id:"7-10",text:"LinkedIn: post weekly project updates with screenshots",tag:"apply",xp:40},
  ]},
  {id:8,name:"Job Hunt & Freelance Launch",emoji:"ğŸ’¼",color:"#6d28d9",weeks:"Weeks 31â€“52",desc:"Resume, interviews, freelance clients, Upwork, first paid projects",tasks:[
    {id:"8-1",text:"Build ATS-friendly resume. Claude reviews and rewrites",tag:"apply",xp:80},
    {id:"8-2",text:"LinkedIn optimisation: headline, about, projects",tag:"apply",xp:60},
    {id:"8-3",text:"Create Upwork profile. First 3 proposals sent",tag:"apply",xp:70},
    {id:"8-4",text:"Create Fiverr gig: static website development",tag:"apply",xp:60},
    {id:"8-5",text:"Daily: 5 job applications OR 5 freelance proposals",tag:"apply",xp:50},
    {id:"8-6",text:"Interview prep: Claude daily mock technical Q&A",tag:"review",xp:30},
    {id:"8-7",text:"LeetCode: 2 Easy/Medium problems daily",tag:"build",xp:40},
    {id:"8-8",text:"System design basics: databases, caching, load balancing",tag:"learn",xp:80},
    {id:"8-9",text:"First freelance client: deliver on time, get 5-star review",tag:"apply",xp:300},
    {id:"8-10",text:"First paid employment offer received and negotiated",tag:"apply",xp:500},
    {id:"8-11",text:"Open source: merged first PR into real project",tag:"build",xp:150},
    {id:"8-12",text:"ğŸ† FINAL BOSS: Claude Pro paid from YOUR earnings!",tag:"apply",xp:1000},
  ]},
];

const NN=[
  {id:"nc",emoji:"ğŸ’»",name:"GitHub Commit"},
  {id:"nl",emoji:"ğŸ“š",name:"1 Lesson"},
  {id:"nw",emoji:"âŒ¨ï¸",name:"20 Lines Code"},
  {id:"na",emoji:"ğŸ¤–",name:"Ask Claude"},
  {id:"nj",emoji:"ğŸ“”",name:"Journal"},
  {id:"nm",emoji:"ğŸƒ",name:"Exercise"},
];

const ACHS=[
  {id:"a1",e:"âœ…",n:"First Task",f:s=>s.tt>=1},
  {id:"a2",e:"ğŸ”¥",n:"3-Day Streak",f:s=>s.str>=3},
  {id:"a3",e:"ğŸ“…",n:"One Week",f:s=>s.tt>=18},
  {id:"a4",e:"ğŸ’¯",n:"100 XP",f:s=>s.xp>=100},
  {id:"a5",e:"ğŸ",n:"Phase 1 Done",f:s=>s.cp>=1},
  {id:"a6",e:"ğŸ“”",n:"3 Journals",f:s=>s.jc>=3},
  {id:"a7",e:"âš¡",n:"500 XP",f:s=>s.xp>=500},
  {id:"a8",e:"ğŸŒŸ",n:"7-Day Streak",f:s=>s.str>=7},
  {id:"a9",e:"ğŸ’°",n:"First Client",f:s=>s.cp>=7},
  {id:"a10",e:"ğŸ†",n:"1000 XP",f:s=>s.xp>=1000},
  {id:"a11",e:"ğŸ¯",n:"Halfway There",f:s=>s.cp>=4},
  {id:"a12",e:"ğŸ‘‘",n:"Full Stack Dev",f:s=>s.cp>=8},
];

const LVLS=[
  {l:1,t:"Absolute Beginner",m:0},{l:2,t:"Enthusiastic Learner",m:500},
  {l:3,t:"Syntax Survivor",m:1200},{l:4,t:"Function Fighter",m:2500},
  {l:5,t:"Component Crafter",m:4000},{l:6,t:"API Architect",m:6000},
  {l:7,t:"Full Stack Warrior",m:9000},{l:8,t:"AI-Augmented Dev",m:13000},
  {l:9,t:"Freelance Legend",m:18000},{l:10,t:"The Developer",m:25000},
];

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// STATE
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
let S={tasks:{},nn:{},str:0,xp:0,tt:0,cp:0,jc:0,start:null,days:{}};

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// STORAGE â€” localStorage with cloud fallback
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
const KEY='cj3';
function persist(){
  try{localStorage.setItem(KEY,JSON.stringify(S))}catch(e){}
  try{window.storage&&window.storage.set(KEY,JSON.stringify(S))}catch(e){}
}
async function hydrate(){
  // Try cloud first
  try{
    const r=await window.storage.get(KEY);
    if(r&&r.value){S={...S,...JSON.parse(r.value)};return}
  }catch(e){}
  // Fall back to localStorage
  try{
    const s=localStorage.getItem(KEY);
    if(s)S={...S,...JSON.parse(s)};
  }catch(e){}
}

// Journal entries stored separately per day
async function writeEntry(e){
  const k=KEY+'-j-'+e.date;
  try{localStorage.setItem(k,JSON.stringify(e))}catch(err){}
  try{window.storage&&await window.storage.set(k,JSON.stringify(e))}catch(err){}
}
async function readEntries(){
  const out=[];
  for(let i=0;i<30;i++){
    const d=new Date();d.setDate(d.getDate()-i);
    const ds=fmtDate(d);
    const k=KEY+'-j-'+ds;
    let found=null;
    try{const r=await window.storage.get(k);if(r&&r.value)found=JSON.parse(r.value)}catch(e){}
    if(!found){try{const s=localStorage.getItem(k);if(s)found=JSON.parse(s)}catch(e){}}
    if(found)out.push(found);
  }
  return out;
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// UTILS
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
const fmtDate=d=>d.toISOString().split('T')[0];
const today=()=>fmtDate(new Date());
const daysSince=d=>{if(!d)return 0;return Math.max(0,Math.floor((new Date()-new Date(d))/86400000))};
const greetMsg=()=>{const h=new Date().getHours();return h<12?"Good morning, Developer":h<17?"Good afternoon, Developer":"Good evening, Developer"};

function phIdx(){
  for(let i=0;i<PLAN.length;i++){
    if(PLAN[i].tasks.filter(t=>S.tasks[t.id]).length<PLAN[i].tasks.length)return i;
  }
  return PLAN.length-1;
}
function pct(){
  const tot=PLAN.reduce((s,p)=>s+p.tasks.length,0);
  const dn=PLAN.reduce((s,p)=>s+p.tasks.filter(t=>S.tasks[t.id]).length,0);
  return tot?Math.round(dn/tot*100):0;
}
function getLvl(){for(let i=LVLS.length-1;i>=0;i--)if(S.xp>=LVLS[i].m)return LVLS[i];return LVLS[0]}
function recalc(){
  S.tt=Object.keys(S.tasks).length;
  S.xp=PLAN.reduce((s,p)=>s+p.tasks.filter(t=>S.tasks[t.id]).reduce((a,t)=>a+t.xp,0),0);
  S.cp=PLAN.filter(p=>p.tasks.every(t=>S.tasks[t.id])).length;
  let str=0;const now=new Date();
  for(let i=0;i<365;i++){
    const d=new Date(now);d.setDate(d.getDate()-i);
    if(S.days[fmtDate(d)])str++;else if(i>0)break;
  }
  S.str=str;
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// RENDER â€” HOME
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
function rHome(){
  const dn=daysSince(S.start)+1;
  document.getElementById('greet').textContent=greetMsg();
  document.getElementById('dayN').textContent=dn;
  document.getElementById('piD').textContent=dn;
  document.getElementById('piR').textContent=Math.max(0,365-dn);
  // ring
  const p=pct();
  document.getElementById('rPct').textContent=p+'%';
  const r=30,c=2*Math.PI*r,off=c-p/100*c;
  document.getElementById('rFill').style.strokeDasharray=c;
  document.getElementById('rFill').style.strokeDashoffset=off;
  // phase
  const pi=phIdx(),cp=PLAN[pi];
  document.getElementById('piPh').textContent=`Phase ${cp.id} ${cp.emoji}`;
  document.getElementById('piNm').textContent=cp.name;
  // badges
  document.getElementById('xpVal').textContent=S.xp;
  document.getElementById('strBadge').textContent=`ğŸ”¥ ${S.str}`;
  rTasks(cp);rNN();rCal();
}

function tagClass(t){return t==='learn'?'tl':t==='build'?'tb':t==='review'?'tr':t==='apply'?'ta':'tc'}

function rTasks(phase){
  const el=document.getElementById('taskList');
  const undone=phase.tasks.filter(t=>!S.tasks[t.id]).slice(0,5);
  const done2=phase.tasks.filter(t=>S.tasks[t.id]).slice(-2);
  const list=[...undone,...done2].slice(0,6);
  const doneN=phase.tasks.filter(t=>S.tasks[t.id]).length;
  document.getElementById('tCount').textContent=`${doneN}/${phase.tasks.length}`;
  el.innerHTML='';
  if(!list.length){el.innerHTML='<div class="empty"><div class="empty-i">ğŸ‰</div>Phase complete!<br>Tap Phases to see all tasks.</div>';return}
  list.forEach(task=>{
    const done=!!S.tasks[task.id];
    const d=document.createElement('div');
    d.className='task'+(done?' done':'');
    d.style.borderLeftColor=done?'var(--dim)':phase.color;
    d.innerHTML=`<div class="chk">${done?'âœ“':''}</div><div class="t-body"><div class="t-txt">${task.text}</div><div class="t-meta"><span class="tag ${tagClass(task.tag)}">${task.tag}</span><span class="t-xp">+${task.xp} XP</span></div></div>`;
    if(!done)d.onclick=()=>doTask(task,d,phase.color);
    el.appendChild(d);
  });
}

function rNN(){
  const g=document.getElementById('nnGrid'),td=today();
  let cnt=0;g.innerHTML='';
  NN.forEach(n=>{
    const k=`${n.id}-${td}`,done=!!S.nn[k];
    if(done)cnt++;
    const el=document.createElement('div');
    el.className='nn'+(done?' done':'');
    el.innerHTML=`<div class="nn-e">${n.emoji}</div><div class="nn-n">${n.name}</div>`;
    el.onclick=()=>togNN(n,k,el);
    g.appendChild(el);
  });
  document.getElementById('nnCount').textContent=`${cnt}/6`;
}

function rCal(){
  const g=document.getElementById('calGrid');g.innerHTML='';
  const now=new Date();
  for(let i=27;i>=0;i--){
    const d=new Date(now);d.setDate(d.getDate()-i);
    const ds=fmtDate(d);
    const el=document.createElement('div');
    el.className='cal-d'+(S.days[ds]?' done':'')+(i===0?' today':'');
    el.textContent=d.getDate();
    g.appendChild(el);
  }
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// RENDER â€” PHASES
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
function rPhases(){
  const c=document.getElementById('phasesList');c.innerHTML='';
  const ci=phIdx();
  PLAN.forEach((p,i)=>{
    const dn=p.tasks.filter(t=>S.tasks[t.id]).length;
    const tot=p.tasks.length,pc=Math.round(dn/tot*100);
    const cls=dn===tot?'done2':i===ci?'cur':'';
    const d=document.createElement('div');
    d.className=`ph-card ${cls}`;
    d.innerHTML=`<div class="ph-hdr"><div class="ph-badge" style="background:${p.color}20;color:${p.color};border:1px solid ${p.color}40">${dn===tot?'âœ“':p.emoji}</div><div class="ph-info"><div class="ph-name">${p.name}</div><div class="ph-wk">${p.weeks} Â· ${tot} tasks</div></div></div><div class="ph-prog"><div class="ph-bar"><div class="ph-fill" style="width:${pc}%;background:${p.color}"></div></div><div class="ph-st"><span>${p.desc.slice(0,44)}â€¦</span><span class="${dn>0?'gn':''}">${dn}/${tot}</span></div></div>`;
    d.onclick=()=>openM(p);
    c.appendChild(d);
  });
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// RENDER â€” STATS
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
function rStats(){
  const lvl=getLvl();
  const nxt=LVLS.find(l=>l.l===lvl.l+1)||lvl;
  const pr=lvl.l<10?Math.round((S.xp-lvl.m)/(nxt.m-lvl.m)*100):100;
  document.getElementById('lvlLbl').textContent=`Level ${lvl.l}`;
  document.getElementById('lvlTitle').textContent=lvl.t;
  document.getElementById('xpBar').style.width=pr+'%';
  document.getElementById('xpTxt').textContent=lvl.l<10?`${S.xp-lvl.m} / ${nxt.m-lvl.m} XP to Level ${nxt.l}`:'MAX LEVEL!';
  document.getElementById('ss').textContent=S.str;
  document.getElementById('st').textContent=S.tt;
  document.getElementById('sx').textContent=S.xp;
  document.getElementById('sj').textContent=S.jc;
  const ag=document.getElementById('achGrid');ag.innerHTML='';
  ACHS.forEach(a=>{
    const u=a.f(S);const el=document.createElement('div');
    el.className='ach'+(u?' on':'');
    el.innerHTML=`<div class="a-e">${a.e}</div><div class="a-n">${a.n}</div>`;
    ag.appendChild(el);
  });
  const pb=document.getElementById('phBars');pb.innerHTML='';
  PLAN.forEach(p=>{
    const dn=p.tasks.filter(t=>S.tasks[t.id]).length;
    const tot=p.tasks.length,pc=Math.round(dn/tot*100);
    pb.innerHTML+=`<div style="margin-bottom:8px"><div style="display:flex;justify-content:space-between;margin-bottom:3px"><span style="font-size:.75rem;color:var(--muted)">${p.emoji} ${p.name}</span><span style="font-family:'JetBrains Mono',monospace;font-size:9px;color:${p.color}">${dn}/${tot}</span></div><div style="height:3px;background:var(--s3);border-radius:2px;overflow:hidden"><div style="height:100%;width:${pc}%;background:${p.color};border-radius:2px;transition:width .5s"></div></div></div>`;
  });
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// RENDER â€” JOURNAL
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
async function rJournal(){
  document.getElementById('jDate').textContent=new Date().toLocaleDateString('en-IN',{weekday:'long',year:'numeric',month:'long',day:'numeric'});
  const entries=await readEntries();
  const el=document.getElementById('eList');el.innerHTML='';
  if(!entries.length){el.innerHTML='<div class="empty"><div class="empty-i">ğŸ“”</div>No entries yet.<br>Write your first one above!</div>';return}
  entries.forEach(e=>{
    const d=new Date(e.date);
    const c=document.createElement('div');c.className='e-card';
    c.innerHTML=`<div class="e-date">${d.toLocaleDateString('en-IN',{weekday:'short',month:'short',day:'numeric'})}</div><div class="e-body">${e.b?`<div>ğŸ”¨ ${e.b}</div>`:''}${e.c?`<div style="margin-top:4px">ğŸ’¡ ${e.c}</div>`:''}${e.cl?`<div style="margin-top:4px">ğŸ¤– ${e.cl}</div>`:''}</div>`;
    el.appendChild(c);
  });
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// INTERACTIONS
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
function doTask(task,el,color){
  if(S.tasks[task.id])return;
  S.tasks[task.id]=true;S.days[today()]=true;recalc();
  const r=el.getBoundingClientRect();
  const b=document.createElement('div');b.className='burst';
  b.textContent='+'+task.xp+' XP';b.style.left=(r.left+r.width/2-25)+'px';b.style.top=(r.top-6)+'px';
  document.body.appendChild(b);setTimeout(()=>b.remove(),800);
  el.classList.add('done');el.style.borderLeftColor='var(--dim)';
  el.querySelector('.chk').textContent='âœ“';
  el.querySelector('.chk').style.cssText='background:var(--green);border-color:var(--green);color:#fff';
  el.querySelector('.t-txt').style.textDecoration='line-through';
  el.onclick=null;
  toast(`+${task.xp} XP! ğŸ”¥`,'gld');persist();rHome();
}

function togNN(n,k,el){
  const was=!!S.nn[k];S.nn[k]=!was;
  el.classList.toggle('done');
  if(!was){S.days[today()]=true;S.xp+=10;toast(`${n.emoji} +10 XP`,'gld')}
  else S.xp=Math.max(0,S.xp-10);
  recalc();document.getElementById('xpVal').textContent=S.xp;
  persist();rNN();
}

function openM(phase){
  document.getElementById('mTitle').textContent=`${phase.emoji} ${phase.name}`;
  document.getElementById('mSub').textContent=phase.weeks+' Â· '+phase.desc;
  const list=document.getElementById('mTasks');list.innerHTML='';
  phase.tasks.forEach(task=>{
    const done=!!S.tasks[task.id];
    const el=document.createElement('div');el.className='mt'+(done?' done':'');
    el.innerHTML=`<div class="mt-chk">${done?'âœ“':''}</div><div class="mt-t">${task.text}</div><div class="mt-x">+${task.xp}</div>`;
    if(!done){el.onclick=()=>{
      S.tasks[task.id]=true;S.days[today()]=true;recalc();persist();
      el.classList.add('done');
      el.querySelector('.mt-chk').textContent='âœ“';
      el.querySelector('.mt-chk').style.cssText='background:var(--green);border-color:var(--green);color:#fff';
      el.onclick=null;
      toast(`+${task.xp} XP! âš¡`,'gld');
      rHome();rPhases();
    }}
    list.appendChild(el);
  });
  document.getElementById('overlay').classList.add('on');
}
function closeM(e){if(e.target===document.getElementById('overlay'))document.getElementById('overlay').classList.remove('on')}

async function saveJ(){
  const b=document.getElementById('jB').value.trim();
  const c=document.getElementById('jC').value.trim();
  const cl=document.getElementById('jCl').value.trim();
  const t=document.getElementById('jT').value.trim();
  if(!b&&!c&&!cl&&!t){toast('Write something first! ğŸ“”','');return}
  await writeEntry({date:today(),b,c,cl,t});
  S.days[today()]=true;S.jc++;S.xp+=25;recalc();persist();
  document.getElementById('jB').value='';document.getElementById('jC').value='';
  document.getElementById('jCl').value='';document.getElementById('jT').value='';
  toast('Journal saved! +25 XP ğŸ“”','grn');rJournal();rHome();
}

function toast(msg,cls){
  const t=document.getElementById('toast');
  t.textContent=msg;t.className='toast '+cls+' on';
  clearTimeout(t._t);t._t=setTimeout(()=>t.classList.remove('on'),2400);
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// NAVIGATION
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
function go(page){
  document.querySelectorAll('.pg').forEach(p=>p.classList.remove('on'));
  document.querySelectorAll('.nav-btn').forEach(b=>b.classList.remove('on'));
  document.getElementById('pg-'+page).classList.add('on');
  document.getElementById('nb-'+page).classList.add('on');
  document.getElementById('scrl').scrollTop=0;
  if(page==='home')rHome();
  else if(page==='phases')rPhases();
  else if(page==='journal')rJournal();
  else if(page==='stats')rStats();
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// INSTALL LOGIC
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
const isIOS=()=>/iphone|ipad|ipod/i.test(navigator.userAgent)&&!window.MSStream;
const isInstalled=()=>window.matchMedia('(display-mode:standalone)').matches||window.navigator.standalone===true;
let deferredPrompt=null;

function showApp(){
  document.getElementById('installScreen').classList.add('hidden');
  document.getElementById('app').style.display='flex';
}

function initInstallScreen(){
  if(isInstalled()){showApp();return}

  if(isIOS()){
    // Show iOS step-by-step guide
    document.getElementById('iosGuide').style.display='block';
  } else if(deferredPrompt){
    // Android/Chrome â€” show install button
    document.getElementById('installBtn').style.display='block';
  } else {
    // No install available (Firefox, etc.) â€” just show skip
  }
  document.getElementById('installScreen').style.display='flex'; // show it
}

document.getElementById('installBtn').onclick=async()=>{
  if(!deferredPrompt)return;
  deferredPrompt.prompt();
  const{outcome}=await deferredPrompt.userChoice;
  if(outcome==='accepted')showApp();
  deferredPrompt=null;
};

document.getElementById('skipBtn').onclick=showApp;

window.addEventListener('beforeinstallprompt',e=>{
  e.preventDefault();deferredPrompt=e;
  document.getElementById('installBtn').style.display='block';
});

window.addEventListener('appinstalled',()=>{
  showApp();toast('App installed! âš¡ Welcome.','grn');
});

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// SERVICE WORKER
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
if('serviceWorker' in navigator){
  const sw=`
const V='cj3-v1',FILES=['/'];
self.addEventListener('install',e=>{
  e.waitUntil(caches.open(V).then(c=>c.addAll(FILES)).then(()=>self.skipWaiting()));
});
self.addEventListener('activate',e=>e.waitUntil(clients.claim()));
self.addEventListener('fetch',e=>{
  e.respondWith(caches.match(e.request).then(h=>h||fetch(e.request).then(r=>{
    const rc=r.clone();
    caches.open(V).then(c=>c.put(e.request,rc));
    return r;
  }).catch(()=>h)));
});`;
  navigator.serviceWorker.register(
    URL.createObjectURL(new Blob([sw],{type:'application/javascript'}))
  ).catch(()=>{});
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// BOOT
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
async function boot(){
  await hydrate();
  if(!S.start){S.start=today();persist()}
  recalc();
  initInstallScreen();
  // If already installed, show app and render
  if(isInstalled()){rHome()}
}
boot();
</script>
</body>
</html>
